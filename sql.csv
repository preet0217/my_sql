SELECT 
         dates_rollup.date                  AS day
         ,COALESCE(SUM(orders), 0)          AS orders
         ,COALESCE(SUM(line_items), 0)      AS items_ordered

         ,COUNT(*) as rows
FROM dsv1069.dates_rollup
LEFT OUTER JOIN 
      (
      SELECT DATE(paid_at)                           as day
     -- ,EXTRACT(MONTH FROM orders.paid_at) as month
     -- ,EXTRACT(YEAR FROM orders.paid_at) as year
     ,COUNT(distinct invoice_id)                            as orders
     ,COUNT(distinct line_item_id)                          as line_items
      FROM dsv1069.orders
      GROUP BY day

      ) daily_orders
ON 
dates_rollup.date>=daily_orders.day
AND
dates_rollup.d7_ago<daily_orders.day
GROUP BY  dates_rollup.date 